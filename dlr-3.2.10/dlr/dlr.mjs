/*!
* Dynamsoft JavaScript Library
* @product Dynamsoft Label Recognizer JS Edition
* @website http://www.dynamsoft.com
* @copyright Copyright 2024, Dynamsoft Corporation
* @author Dynamsoft
* @version 3.0.30-dev-20240326165358
* @fileoverview Dynamsoft JavaScript Library for Barcode Reader
* More info on dlr JS: https://www.dynamsoft.com/label-recognition/docs/web/programming/javascript/
*/
import{engineResourcePaths as t,workerAutoResources as e,mapPackageRegister as a,compareVersion as s,innerVersions as r,loadWasm as c,getNextTaskID as n,mapTaskCallBack as o,worker as l,CoreModule as i}from"dynamsoft-core";const h="undefined"==typeof self,u=(()=>{if(!h&&document.currentScript){let t=document.currentScript.src,e=t.indexOf("?");if(-1!=e)t=t.substring(0,e);else{let e=t.indexOf("#");-1!=e&&(t=t.substring(0,e))}return t.substring(0,t.lastIndexOf("/")+1)}return"./"})(),d=t=>{if(null==t&&(t="./"),h);else{let e=document.createElement("a");e.href=t,t=e.href}return t.endsWith("/")||(t+="/"),t};null==t.dlr&&(t.dlr=u),null==t.dlrData&&(t.dlrData=d(u+"../../dynamsoft-label-recognizer-data/dist/")),e.dlr={js:!0,wasm:!0,deps:["license","dip","dnn"]},e.dnn={wasm:!0},a.dlr={filterVINResult:function(t){let e="";if(18===t.characterResults.length){let e=t.characterResults[9].location.points[0].x-t.characterResults[8].location.points[1].x;e<2&&(e=2);let a=t.characterResults[1].location.points[0].x-t.characterResults[0].location.points[1].x,s=t.characterResults[17].location.points[0].x-t.characterResults[16].location.points[1].x,r=2===e?3:e;if(a-e>=r&&s-e<r)t.characterResults.shift();else if(s-e>=r&&a-e<r)t.characterResults.pop();else{t.characterResults[0].characterHConfidence>t.characterResults[17].characterHConfidence?t.characterResults.pop():t.characterResults.shift()}}else if(19===t.characterResults.length){let e=t.characterResults[10].location.points[0].x-t.characterResults[9].location.points[1].x;e<2&&(e=2);let a,s,r,c=t.characterResults[1].location.points[0].x-t.characterResults[0].location.points[1].x,n=t.characterResults[18].location.points[0].x-t.characterResults[17].location.points[1].x,o=t.characterResults[2].location.points[0].x-t.characterResults[1].location.points[1].x,l=t.characterResults[17].location.points[0].x-t.characterResults[16].location.points[1].x,i=2===e?3:e;if("1"===t.characterResults[1].characterH||"1"===t.characterResults[2].characterH||"1"===t.characterResults[16].characterH||"1"===t.characterResults[17].characterH){for(let e=9;e<t.characterResults.length;e++)if("1"!==t.characterResults[e].characterH){r=t.characterResults[e].location.points[1].x-t.characterResults[e].location.points[0].x;break}"1"===t.characterResults[1].characterH&&(a=r-(t.characterResults[1].location.points[1].x-t.characterResults[1].location.points[0].x)+3),"1"===t.characterResults[2].characterH&&(a=r-(t.characterResults[2].location.points[1].x-t.characterResults[2].location.points[0].x)+3),"1"===t.characterResults[16].characterH&&(s=r-(t.characterResults[16].location.points[1].x-t.characterResults[16].location.points[0].x)+3),"1"===t.characterResults[17].characterH&&(s=r-(t.characterResults[17].location.points[1].x-t.characterResults[17].location.points[0].x)+3)}if(o-e>=(a||i)&&l-e<(s||i))t.characterResults.splice(0,2);else if(l-e>=(s||i)&&o-e<(a||i))t.characterResults.splice(17,2);else if(c>e&&n>e)t.characterResults.pop(),t.characterResults.shift();else{let e=t.characterResults[0].characterHConfidence+t.characterResults[1].characterHConfidence,a=t.characterResults[17].characterHConfidence+t.characterResults[18].characterHConfidence,s=t.characterResults[0].characterHConfidence+t.characterResults[18].characterHConfidence,r=Math.min(e,a,s);r===e?t.characterResults.splice(0,2):r===a?t.characterResults.splice(17,2):r===s&&(t.characterResults.pop(),t.characterResults.shift())}}for(let a of t.characterResults)e+=a.characterH;return e}};const p="1.2.0";"string"!=typeof t.std&&s(t.std.version,p)<0&&(t.std={version:p,path:d(u+`../../dynamsoft-capture-vision-std@${p}/dist/`)});const R="2.2.10";(!t.dip||"string"!=typeof t.dip&&s(t.dip.version,R)<0)&&(t.dip={version:R,path:d(u+`../../dynamsoft-image-processing@${R}/dist/`)});const f="1.0.10";(!t.dnn||"string"!=typeof t.dnn&&s(t.dnn.version,f)<0)&&(t.dnn={version:R,path:d(u+`../../dynamsoft-capture-vision-dnn@${f}/dist/`)});class x{static getVersion(){const t=r.dlr&&r.dlr.wasm,e=r.dlr&&r.dlr.worker;return`3.0.30-dev-20240326165358(Worker: ${e||"Not Loaded"}, Wasm: ${t||"Not Loaded"})`}static async loadRecognitionData(t,e){return await c("dlr"),await new Promise(((a,s)=>{let r=n();o[r]=async t=>{if(t.success)return a();{let e=new Error(t.message);return e.stack=t.stack+"\n"+e.stack,s(e)}},e&&!e.endsWith("/")&&(e+="/"),l.postMessage({type:"dlr_appendCaffeModelBuffer",id:r,body:{dataName:t,dataPath:e||i.engineResourcePaths.dlrData}})}))}}o[-1]=async t=>{x.onDataLoadProgressChanged&&x.onDataLoadProgressChanged(t.resourcesPath,t.tag,{loaded:t.loaded,total:t.total})};export{x as LabelRecognizerModule};
